<div class="result-card receipt-container">
  <div class="header">
    <h1>Comprovante de Transação Pix</h1>
    <p class="subtitle">Banco Inter Integration</p>
  </div>

  <% if @error %>
    <div class="alert error">
      <%= @error %>
    </div>
    <%= link_to "Voltar", statements_path, class: "btn-secondary" %>
  <% elsif @pix_data %>
    <div class="receipt-body">
      <div class="row">
        <span class="label">Valor</span>
        <span class="value highlight"><%= number_to_currency(@pix_data['valor'], unit: "R$ ", separator: ",", delimiter: ".") %></span>
      </div>

      <div class="row">
        <span class="label">ID da Transação (E2E)</span>
        <span class="value mono"><%= @pix_data['endToEndId'] %></span>
      </div>

      <div class="row">
        <span class="label">Data/Hora</span>
        <span class="value"><%= DateTime.parse(@pix_data['horario']).strftime("%d/%m/%Y %H:%M:%S") rescue @pix_data['horario'] %></span>
      </div>

      <hr>

      <% if @pix_data['chave'] %>
        <div class="row">
          <span class="label">Chave Pix</span>
          <span class="value"><%= @pix_data['chave'] %></span>
        </div>
      <% end %>

      <% if @pix_data['pagador'] %>
        <h3>Pagador</h3>
        <div class="row">
          <span class="label">Nome</span>
          <span class="value"><%= @pix_data['pagador']['nome'] %></span>
        </div>
        <div class="row">
          <span class="label">CPF/CNPJ</span>
          <span class="value"><%= @pix_data['pagador']['cpf'] || @pix_data['pagador']['cnpj'] %></span>
        </div>
      <% end %>

      <% if @pix_data['recebedor'] %>
        <h3>Recebedor</h3>
        <div class="row">
          <span class="label">Nome</span>
          <span class="value"><%= @pix_data['recebedor']['nome'] %></span>
        </div>
        <div class="row">
          <span class="label">CPF/CNPJ</span>
          <span class="value"><%= @pix_data['recebedor']['cpf'] || @pix_data['recebedor']['cnpj'] %></span>
        </div>
      <% end %>

      <% if @pix_data['infoPagador'] %>
        <div class="row">
          <span class="label">Descrição</span>
          <span class="value"><%= @pix_data['infoPagador'] %></span>
        </div>
      <% end %>
      
      <div class="footer-actions">
        <button onclick="window.print()" class="btn-primary">Imprimir / Salvar PDF</button>
        <%= link_to "Voltar", statements_path, class: "btn-secondary" %>
      </div>
    </div>
  <% end %>
</div>
